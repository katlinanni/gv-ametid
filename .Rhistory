new$new = asendaja(new$new, "juhatajakohusetäitja", "",  replace = "juhataja")
new$new = asendaja(new$new, "asejuhataja", "", excl1 = "asfald", replace = "juhataja")
new$new = asendaja(new$new, "juhatajs", "", replace = "juhataja")
new$new = asendaja(new$new, "töökoja", "juh", excl1 = "käsitöö", excl2 = "metall", excl3 = "puidu", excl4 = "põllumaj", replace = "teenustejuht")
new$new = asendaja(new$new, "salong", "juh", excl1 = "müügisal", excl2 = "mööblisal", replace = "teenustejuht")
new$new = asendaja(new$new, "turismiette", "juh", replace = "teenustejuht")
new$new = asendaja(new$new, "spaa", "juh", replace = "teenustejuht")
new$new = asendaja(new$new, "tehnoül", "juh", replace = "teenustejuht")
new$new = asendaja(new$new, "konverents", "juh", excl1 = "programm", replace = "teenustejuht")
new$new = asendaja(new$new, "kõnekes", "juh", replace = "teenustejuht")
new$new = asendaja(new$new, "teenustejuht", "", excl1 = "tervishoiu", excl2 = "kutse", excl3 = "tugi", replace = "teenustejuht")
new$new = asendaja(new$new, "kalmistu", "juh", replace = "teenustejuht")
new$new = asendaja(new$new, "agentuur", "juh", replace = "teenustejuht")
unique(leidur(new$new, "teenindusjuh",""))
new$new = asendaja(new$new, "teenindusjuh", "", excl1 = "kliendi", excl2 = "toitlus", replace = "teenindusjuht")
table(leidur(new$new, "juhataja", "", "")) %>% sort(decreasing = T)
unique(leidur(new$new, "töödejuh", ""))
new$new = asendaja(new$new, "töödejuh", "puhastus", replace = "majapidaja")
new$new = asendaja(new$new, "ühiselamu", "juh", replace = "majapidaja")
new$new = asendaja(new$new, "majutus", "juh", excl1 = "ettevõt", replace = "majapidaja")
new$new = asendaja(new$new, "töödejuh", "mehaan", replace = "tootmistöödejuhataja")
new$new = asendaja(new$new, "tootmistöödejuh", "", replace = "tootmistöödejuhataja")
new$new = asendaja(new$new, "tootmis", "plan", excl1 = "müügi", replace = "tootmistöödejuhataja")
new$new = asendaja(new$new, "töödejuh", "elektri", replace = "ehitustöödejuhataja")
new$new = asendaja(new$new, "teemeister", "", replace = "ehitustöödejuhataja")
new$new = asendaja(new$new, "töödejuh", "", excl1 = "tootmis", excl2 = "ehitus", replace = "töödejuhataja")
new$new = asendaja(new$new, "objektijuht", "", replace = "töödejuhataja")
new$new = asendaja(new$new, "tööjuht", "", excl1 = "kliinil", excl2 = "vastuv", excl3 = "konsul", replace = "töödejuhataja")
new$new = asendaja(new$new, "^brigaadijuht$", "", replace = "töödejuhataja")
new$new = asendaja(new$new, "tööde", "juh", excl1 = "ehitus", excl2 = "tootmis", replace = "töödejuhataja")
unique(leidur(new$new, "eraettevõtte", "juh"))
new$new = asendaja(new$new, "eraettevõtte", "juh", replace = "ettevõttejuht")
new$new = asendaja(new$new, "hooldekodujuh", "", replace = "eakatehooldusteenusejuht")
new$new = asendaja(new$new, "vanuritekod", "juh", replace = "eakatehooldusteenusejuht")
new$new = asendaja(new$new, "noortekes", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "rahvamaja", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "kultuur", "juh", excl1 = "programm", excl2 = "valdkon", excl3 = "ameti", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "teatrijuht", "", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "spordik", "juh", excl1 = "meeskonna", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "spordib", "juh", excl1 = "meeskonna", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "spordialal", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "kinojuh", "", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "kasiinojuh", "", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "joogast", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "keskastme", "juh", "kultuur", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "spordijuht", "", excl1 = "sõjaväe", excl2 = "eksprodi", excl3 = "transpordi", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "kultuurikorraldaja", "", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "turismitalu", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "huvikeskuse", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "puhkeasutus", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "ujula", "juh", replace = "vabaajakeskustejuht")
new$new = asendaja(new$new, "päevakes", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "lastekod", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "sotsiaalmaj", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "hoolekande", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "päevak", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "sotsiaalt", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "sotsiaalk", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "tugiteen", "juh", replace = "sotsiaalhoolekandejuht") # ei pruugi olla sotsiaalhoolekanne, aga... ?
new$new = asendaja(new$new, "noorsoo", "juh", replace = "sotsiaalhoolekandejuht")
new$new = asendaja(new$new, "perek", "juh", replace = "sotsiaalhoolekandejuht")
unique(leidur(new$new, "enda", "ettevõt"))
new$new = asendaja(new$new, "enda", "ettevõt", replace = "ettevõtja")
new$new = asendaja(new$new, "ettevõtja", "", replace = "ettevõtja")
new$new = asendaja(new$new, "ettevõtte", "asut", replace = "ettevõtja")
table(leidur(new$new, "juht", "", "")) %>% sort(decreasing = T) %>% .[1:150]
unique(leidur(new$new, "keskastmejuht", ""))
new$new = asendaja(new$new, "keskastmejuht", "", replace = "juht")
new$new = asendaja(new$new, "regioonijuht", "", replace = "juht")
new$new = asendaja(new$new, "tippjuht", "", excl1 = "rätsep", replace = "juht")
new$new = asendaja(new$new, "piirkonnajuht", "", replace = "juht")
new$new = asendaja(new$new, "asejuht", "", excl1 = "üliõp", replace = "juht")
new$new = asendaja(new$new, "mtüjuh", "", replace = "juht")
new$new = asendaja(new$new, "talitusejuht", "", replace = "juht")
new$new = asendaja(new$new, "juhatusejuht", "", replace = "ettevõttejuht")
new$new = asendaja(new$new, "asutusejuht", "", excl1 = "õpetaja", excl2 = "kohaliku", excl3 = "kov", replace = "ettevõttejuht")
new$new = asendaja(new$new, "digiturundusejuht", "", replace = "turundusjuht")
new$new = asendaja(new$new, "transpordijuht", "", replace = "tarneahelajuht")
# ISCO-s pole ühtegi meeskonna-tiimijuhi koodi - osad on küll valdkonna ka täpsustanud, aga paljud on väga ebamäärased ehk paneks kõik lihtsalt kokku tiimijuhtideks?
# või on meeskonna/tiimijuht sama mis osakonnajuhataja? Sellisel juhul saaks valdkonna kaudu osad liigitada küll... ?
unique(leidur(new$new, "meeskonnajuht", ""))
new$new = asendaja(new$new, "meeskonnajuht", "", replace = "tiimijuht")
new$new = asendaja(new$new, "tiimijuht", "", replace = "tiimijuht")
new$new = asendaja(new$new, "tiim", "liider", replace = "tiimijuht")
new$new = asendaja(new$new, "vastavuskontroll", "", replace = "jurist")
new$new = asendaja(new$new, "juriidilinenõustaja", "", replace = "jurist")
new$new = asendaja(new$new, "juht", "klienditeen", replace = "klienditeenindusjuht")
new$new = asendaja(new$new, "klienditeenindusjuht", "", replace = "kontorijuhataja")
unique(leidur(new$new, "juht", "kliendi"))
new$new = asendaja(new$new, "juht", "kliendi", excl1 = "klienditeen", excl2 = "lahendus", excl3 = "projekt", replace = "finantsnõustaja")
new$new = asendaja(new$new, "juh", "strateeg", excl1 = "nõust", replace = "strateegiajuht")
new$new = asendaja(new$new, "planeerim", "juh", excl1 = "too", excl2 = "grupi", replace = "strateegiajuht")
new$new = asendaja(new$new, "poliitika", "juh", replace = "strateegiajuht")
unique(leidur(new$new, "fin", "juh"))
new$new = asendaja(new$new, "juh", "fin", excl1 = "tartu", excl2 = "praktika", excl3 = "teenindus", excl4 = "ettevõttejuht", replace = "finantsjuht")
new$new = asendaja(new$new, "juh", "eelarve", replace = "finantsjuht")
new$new = asendaja(new$new, "tegevjuht", "", excl1 = "disainer", replace = "tegevjuht")
new$new = asendaja(new$new, "ceo", "", excl1 = "compliance", replace = "tegevjuht")
new$new = asendaja(new$new, "juhtaja", "", replace = "juhataja")
new$new = asendaja(new$new, "hooldesõiduki", "juh", replace = "teemasinajuht")
new$new = asendaja(new$new, "sõidukijuht", "", replace = "autojuht")
new$new = asendaja(new$new, "juh", "põllumaj", replace = "põllumetsandusjuht")
new$new = asendaja(new$new, "juh", "metsa", excl1 = "masina", replace = "põllumetsandusjuht")
new$new = asendaja(new$new, "müügi", "juhataja", replace = "kaubandusjuht")
new$new = asendaja(new$new, "tankla", "juh", replace = "kaubandusjuht")
new$new = asendaja(new$new, "kommertsjuht", "", replace = "kaubandusjuht")
new$new = asendaja(new$new, "teenindusjaamajuhataja", "", replace = "kaubandusjuht")
unique(leidur(new$new, "ametiühingu", ""))
new$new = asendaja(new$new, "ametiühingu", "", replace = "ametiühinguesimees")
new$new = asendaja(new$new, "apteegi", "abitöö", replace = "muu tervishoiuhooldustöötaja")
new$new = asendaja(new$new, "õe", "abiline", replace = "muu tervishoiuhooldustöötaja")
new$new = asendaja(new$new, "desinfektor", "", replace = "muu tervishoiuhooldustöötaja")
new$new = asendaja(new$new, "labori", "abi", replace = "muu tervishoiuhooldustöötaja")
new$new = asendaja(new$new, "sterilis", "", replace = "muu tervishoiuhooldustöötaja")
new$new = asendaja(new$new, "koroona", "test", replace = "muu tervishoiuhooldustöötaja")
unique(leidur(new$new, "arsti", "abi"))
new$new = asendaja(new$new, "arsti", "abi", replace = "abiarst")
# ISCO-s on allolevad kõik ühe koodi all
unique(leidur(new$new, "arheoloog", ""))
new$new = asendaja(new$new, "arheoloog", "", excl1 = "digit", excl2 = "abi", replace = "arheoloog")
new$new = asendaja(new$new, "sotsioloog", "", replace = "sotsioloog")
new$new = asendaja(new$new, "antropoloog", "", replace = "antropoloog")
new$new = asendaja(new$new, "geograaf", "", replace = "geograaf")
unique(leidur(new$new, "registripidaja", ""))
new$new = asendaja(new$new, "registripidaja", "", replace = "registripidaja")
new$new = asendaja(new$new, "registri", "hal", replace = "registripidaja")
new$new = asendaja(new$new, "registri", "spets", replace = "registripidaja")
unique(leidur(new$new, "plekksepp", ""))
new$new = asendaja(new$new, "plekksepp", "", replace = "plekksepp")
new$new = asendaja(new$new, "autokeretehnik", "", replace = "plekksepp")
unique(leidur(new$new, "tantsija", ""))
new$new = asendaja(new$new, "tantsija", "", replace = "tantsija")
new$new = asendaja(new$new, "koreograaf", "", replace = "tantsija")
unique(leidur(new$new, "betoneerija", ""))
new$new = asendaja(new$new, "betoneeri", "", replace = "betoneerija")
new$new = asendaja(new$new, "betoon", "töö", replace = "betoneerija")
new$new = asendaja(new$new, "armeer", "", replace = "betoneerija")
new$new = asendaja(new$new, "betoon", "valmis", replace = "betoneerija")
unique(leidur(new$new, "ehitustehnik", ""))
new$new = asendaja(new$new, "ehitustehnik", "", excl1 = "masina", excl2 = "võrgu", replace = "ehitustehnik")
new$new = asendaja(new$new, "ehitus", "järeleval", replace = "ehitustehnik")
new$new = asendaja(new$new, "tuleohu", "inspekt", replace = "ehitustehnik")
new$new = asendaja(new$new, "ehituskonstruktsioonidetehnik", "", replace = "ehitustehnik")
new$new = asendaja(new$new, "tuleohutus", "spets", replace = "ehitustehnik")
new$new = asendaja(new$new, "planeering", "spets", replace = "ehitustehnik")
unique(leidur(new$new, "korstnapüh", ""))
new$new = asendaja(new$new, "korstnapüh", "", replace = "ehitustarindite puhastaja")
new$new = asendaja(new$new, "ehitus", "puhastaja", replace = "ehitustarindite puhastaja")
unique(leidur(new$new, "elektrisead", "koostaja"))
new$new = asendaja(new$new, "elektrisead", "koostaja", replace = "elektriseadmete koostaja")
new$new = asendaja(new$new, "elektr", "mont", replace = "elektriseadmete koostaja")
new$new = asendaja(new$new, "elektriliinide", "paigaldaja", replace = "elektriliinide paigaldaja")
new$new = asendaja(new$new, "kaablikoostaja", "", replace = "elektriliinide paigaldaja")
new$new = asendaja(new$new, "kaablimontöör", "", replace = "elektriliinide paigaldaja")
unique(leidur(new$new, "geoloog", ""))
new$new = asendaja(new$new, "geoloog", "", excl1 = "haldus", replace = "geoloog")
new$new = asendaja(new$new, "geofüüsik", "", replace = "geoloog")
unique(leidur(new$new, "hankejuht", ""))
new$new = asendaja(new$new, "hankejuht", "", replace = "hankejuht")
new$new = asendaja(new$new, "foto", "operaa", replace = "fotomasinaoperaator")
unique(leidur(new$new, "isoleerija", ""))
new$new = asendaja(new$new, "isoleerija", "", replace = "isoleerija")
unique(leidur(new$new, "IT", "turvaspetsialist"))
new$new = asendaja(new$new, "it", "turvaspetsialist", replace = "IT-turvaspetsialist")
new$new = asendaja(new$new, "küberturbe", "", replace = "IT-turvaspetsialist")
new$new = asendaja(new$new, "infoturbespetsialist", "", replace = "IT-turvaspetsialist")
new$new = asendaja(new$new, "juveelitöötleja", "", replace = "juveelitöötleja")
new$new = asendaja(new$new, "juveliir", "", replace = "juveelitöötleja")
new$new = asendaja(new$new, "kulla", "", replace = "juveelitöötleja")
unique(leidur(new$new, "kalur", ""))
new$new = asendaja(new$new, "kalur", "", replace = "kalandustöötaja")
new$new = asendaja(new$new, "kalakasvataja", "", replace = "kalandustöötaja")
unique(leidur(new$new, "keskkon", "insp"))
new$new = asendaja(new$new, "keskkon", "insp", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "pääste", "spets", excl1 = "kolled", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "mere", "insp", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "valitsusehaldusaladeametnik", "", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "ametnik", "omavalits", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "haldusametnik", "", replace = "valitsuse haldusalade ametnik")
new$new = asendaja(new$new, "muinsuskaitsespetsialist", "", replace = "valitsuse haldusalade ametnik")
unique(leidur(new$new, "kiropraktik", ""))
new$new = asendaja(new$new, "kiropraktik", "", replace = "kiropraktik")
unique(leidur(new$new, "kiviraidur", ""))
new$new = asendaja(new$new, "kiviraidur", "", replace = "kivitöötleja")
new$new = asendaja(new$new, "kivitöö", "", replace = "kivitöötleja")
new$new = asendaja(new$new, "kivi", "", excl1 = "paigald", replace = "kivitöötleja")
unique(leidur(new$new, "klaasija", ""))
new$new = asendaja(new$new, "klaasija", "", replace = "klaasija")
new$new = asendaja(new$new, "kohaliku", "tervis", replace = "kohaliku omavalitsuse tervisetöötaja")
new$new = asendaja(new$new, "tervisedendaja", "", replace = "kohaliku omavalitsuse tervisetöötaja")
new$new = asendaja(new$new, "abivahendispetsialist", "", replace = "kohaliku omavalitsuse tervisetöötaja")
unique(leidur(new$new, "kuduja", ""))
new$new = asendaja(new$new, "kuduja", "", replace = "tekstiilikäsitöömeister")
new$new = asendaja(new$new, "nahamei", "", replace = "tekstiilikäsitöömeister")
unique(leidur(new$new, "linnapla", ""))
new$new = asendaja(new$new, "linnaplaneerija", "", replace = "linnaplaneerija")
new$new = asendaja(new$new, "liiklusplaneerija", "", replace = "linnaplaneerija")
unique(leidur(new$new, "maksuamet", ""))
new$new = asendaja(new$new, "maksuametnik", "", replace = "maksuametnik")
new$new = asendaja(new$new, "maksuspetsialist", "", replace = "maksuametnik")
new$new = asendaja(new$new, "maksukonsultant", "", replace = "maksuametnik")
new$new = asendaja(new$new, "maksunõustaja", "", replace = "maksuametnik")
unique(leidur(new$new, "kaub", "vahetusevanem"))
new$new = asendaja(new$new, "müüja", "vahetusevanem", replace = "müüjate vahetusevanem")
new$new = asendaja(new$new, "kaup", "vahetusevanem", replace = "müüjate vahetusevanem")
new$new = asendaja(new$new, "piimatöötleja", "", replace = "piimatöötleja")
new$new = asendaja(new$new, "piimatoodetevalmistaja", "", replace = "piimatöötleja")
new$new = asendaja(new$new, "juustuvalmistaja", "", replace = "piimatöötleja")
new$new = asendaja(new$new, "juustumeister", "", replace = "piimatöötleja")
unique(leidur(new$new, "pillimeister", ""))
new$new = asendaja(new$new, "pillimeister", "", replace = "pillimeister")
new$new = asendaja(new$new, "^tallitöö", "", replace = "põllumajanduse lihttööline")
new$new = asendaja(new$new, "^taimlatöö", "", replace = "põllumajanduse lihttööline")
new$new = asendaja(new$new, "põllumajandustehnik", "", replace = "põllumajandustehnik")
new$new = asendaja(new$new, "seadusandja", "", replace = "seadusandja")
new$new = asendaja(new$new, "minister", "", replace = "seadusandja")
new$new = asendaja(new$new, "riigikoguliige", "", replace = "seadusandja")
new$new = asendaja(new$new, "ametiühinguesimees", "", replace = "seadusandja")
unique(leidur(new$new, "rautaja", ""))
new$new = asendaja(new$new, "rautaja", "", replace = "sepp")
new$new = asendaja(new$new, "käsisepp", "", replace = "sepp")
new$new = asendaja(new$new, "^sepp", "", replace = "sepp")
new$new = asendaja(new$new, "sotsiaalkindlus", "", replace = "sotsiaalkindlustusametnik")
new$new = asendaja(new$new, "stenografist", "", replace = "masinakirjutaja")
new$new = asendaja(new$new, "masinak", "", replace = "masinakirjutaja")
unique(leidur(new$new, "pakkija", ""))
new$new = asendaja(new$new, "tehase", "abitöö", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "pakkija", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "laotööline", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "sorteerija", "", excl1 = "murdesõnastiku", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "tööstuselihttööline", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "mööblifirmaslihttööline", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "^tootmistööline$", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "^tootmistõõline$", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "^tehasetööline$", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "^tootmistöötaja$", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "^tootmisabi$", "", replace = "tööstuselihttööline")
new$new = asendaja(new$new, "telekommunikatsiooniinsener", "", replace = "telekommunikatsiooniinsener")
new$new = asendaja(new$new, "raadioinsener", "", replace = "telekommunikatsiooniinsener")
new$new = asendaja(new$new, "raadiooperaator", "", replace = "telekommunikatsiooniinsener")
new$new = asendaja(new$new, "telekommunikatsioonitehnik", "", replace = "telekommunikatsioonitehnik")
new$new = asendaja(new$new, "sidetehnik", "", replace = "telekommunikatsioonitehnik")
new$new = asendaja(new$new, "toitumisspetsialist", "", replace = "toitumisspetsialist")
new$new = asendaja(new$new, "toitumisnõustaja", "", replace = "toitumisspetsialist")
new$new = asendaja(new$new, "toodete", "testija", replace = "toodetetestija")
new$new = asendaja(new$new, "tootmis", "tehnik", replace = "tootmistehnik")
new$new = asendaja(new$new, "robot", "tehnik", replace = "tootmistehnik")
new$new = asendaja(new$new, "transporditööline", "", replace = "transporditööline")
unique(leidur(new$new, "tööstus", "insener"))
new$new = asendaja(new$new, "tööstus", "insener", replace = "tööstusinsener")
new$new = asendaja(new$new, "tooteinsener", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "tootmistehnoloog", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "õmblus", "tehnoloog", replace = "tööstusinsener")
new$new = asendaja(new$new, "tootmis", "insener", replace = "tööstusinsener")
new$new = asendaja(new$new, "tootearendustehnoloog", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "tootearendaja", "tehno", replace = "tööstusinsener")
new$new = asendaja(new$new, "tootearendusinsener", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "materjalitehnoloog", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "mööbliprojekteerija", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "tekstiilitehnoloog", "", replace = "tööstusinsener")
new$new = asendaja(new$new, "^kvaliteediinsener$", "", replace = "tööstusinsener")
unique(leidur(new$new, "töötervish", "spets"))
new$new = asendaja(new$new, "töötervish", "spets", replace = "töötervishoiuspetsialist")
# coach ehk arengunõustaja?
new$new = asendaja(new$new, "arengunõustaja", "", replace = "muu nõustaja")
new$new = asendaja(new$new, "muunõustaja", "", replace = "muu nõustaja")
new$new = asendaja(new$new, "miljööterapeut", "", replace = "muu nõustaja")
new$new = asendaja(new$new, "vaimsetervisenõustaja", "", replace = "muu nõustaja")
new$new = asendaja(new$new, "astronoom", "", replace = "füüsik")
new$new = asendaja(new$new, "füüsik", "", excl1 = "teadur", excl2 = "töö", excl3 = "geo", replace = "füüsik")
new$new = asendaja(new$new, "litsents", "amet", replace = "litsentsiametnik")
new$new = asendaja(new$new, "täiendmeditsiinispetsialist", "", replace = "täiendmeditsiinispetsialist")
new$new = asendaja(new$new, "kaubaladuja", "", replace = "veondustööline")
new$new = asendaja(new$new, "veondustööline", "", replace = "veondustööline")
new$new = asendaja(new$new, "kaubapaigutaja", "", replace = "veondustööline")
new$new = asendaja(new$new, "transporditööline", "", replace = "veondustööline")
new$new = asendaja(new$new, "toidukuller", "", replace = "veondustööline")
new$new = asendaja(new$new, "kaubakä", "", replace = "veondustööline")
new$new = asendaja(new$new, "ladustaja", "", replace = "veondustööline")
new$new = asendaja(new$new, "liikumisterapeut", "", replace = "liikumisterapeut")
new$new = asendaja(new$new, "keskkonnaanalüütik", "", replace = "keskkonnatehnikaspetsialist")
new$new = asendaja(new$new, "keskkonnatehnikaspetsialist", "", replace = "keskkonnatehnikaspetsialist")
new$new = asendaja(new$new, "keskkonnainsener", "", replace = "keskkonnatehnikaspetsialist")
new$new = asendaja(new$new, "^keskkonnatehnik$", "", replace = "keskkonnatehnikaspetsialist")
new$new = asendaja(new$new, "^keskonnatehnik$", "", replace = "keskkonnatehnikaspetsialist")
new$new = asendaja(new$new, "kaubamaakler", "", replace = "kaubamaakler")
new$new = asendaja(new$new, "laskur", "", replace = "sportlane")
new$new = asendaja(new$new, "sportlane", "", replace = "sportlane")
new$new = asendaja(new$new, "pokker", "", replace = "sportlane")
new$new = asendaja(new$new, "spordiinstruktor", "", replace = "spordiinstruktor")
new$new = asendaja(new$new, "valuutamaakler", "", replace = "valuutamaakler")
new$new = asendaja(new$new, "autopesija", "", replace = "autopesija")
new$new = asendaja(new$new, "stilist", "", replace = "moedisainer")
new$new = asendaja(new$new, "tehnot", "juh", replace = "tehniline juht")
unique(leidur(new$new, "ettevõttejuht", ""))
new$new = asendaja(new$new, "ettevõttejuht", "", excl1 = "väike", excl2 = "oskus", excl3 = "organiseer", replace = "ettevõttejuht")
unique(leidur(new$new, "teadur", ""))
new$new = asendaja(new$new, "teadur", "", excl1 = "andmeteadur", excl2 = "abi",  replace = "teadur")
# 7541 (muud oskus- ja käsitöölised -- allveetöötajad)
unique(leidur(new$new, "tuuker", ""))
new$new = asendaja(new$new, "tuuker", "", replace = "allveetöötaja")
unique(leidur(new$new, "teamlead", ""))
new$new = asendaja(new$new, "teamlead", "", excl1 = "support", replace = "tiimijuht")
unique(leidur(new$new, "kujundaja", ""))
new$new = asendaja(new$new, "kujundaja", "", excl1 = "sise", excl2 = "poliitika", excl3 = "küljendaja", replace = "multimeediadisainer")
new$new = asendaja(new$new, "arvutigraafik", "", replace = "multimeediadisainer")
new$new = asendaja(new$new, "interaktsioonidisainer", "", replace = "multimeediadisainer")
new$new = asendaja(new$new, "kasutajakogemusedisainer", "", replace = "multimeediadisainer")
new$new = asendaja(new$new, "veebidisainer", "", replace = "multimeediadisainer")
new$new = asendaja(new$new, "kujundusgraafik", "", replace = "multimeediadisainer")
# panin kõik praktikandid kokku (neid on vähe nagunii)
unique(leidur(new$new, "praktikant", ""))
new$new = asendaja(new$new, "praktikant", "", replace = "praktikant")
unique(leidur(new$new, "arhitekt", ""))
new$new = asendaja(new$new, "arhitekt", "", excl1 = "maastiku", excl2 = "teenuste", excl3 = "turundus", excl4 = "fie", replace = "ehitusarhitekt")
unique(leidur(new$new, "fie", ""))
new$new = asendaja(new$new, "fie", "", replace = "fie")
unique(leidur(new$new, "analüütik", ""))
new$new = asendaja(new$new, "vanemanalüütik", "", replace = "analüütik")
new$new = asendaja(new$new, "peaanalüütik", "", replace = "analüütik")
table(leidur(new$new, "spetsialist", "", "")) %>% sort(decreasing = T) %>% .[1:30]
unique(leidur(new$new, "vanemspetsialist", ""))
new$new = asendaja(new$new, "vanemspetsialist", "", excl1 = "teh", excl2 = "õhu", excl3 = "kliinil", replace = "peaspetsialist")
new$new = asendaja(new$new, "^vastutavspetsialist", "", replace = "peaspetsialist")
new$new = asendaja(new$new, "koolitusspetsialist", "", replace = "töötajate koolitusspetsialist")
new$new = asendaja(new$new, "tippspetsialist", "", excl1 = "pedagoogika", replace = "spetsialist")
new$new = asendaja(new$new, "kvalitee", "spets", replace = "kvaliteedispetsialist")
new$new = asendaja(new$new, "spatsialist", "", replace = "spetsialist")
# lihtsalt "maakler" - kinnisvaramaakler?
table(leidur(new$new, "maakler", ""))
new$new = asendaja(new$new, "maakler", "", excl1 = "amaakler", excl2 = "tolli", excl3 = "seenior", replace = "kinnisvarahaldur")
table(leidur(new$new, "insener", "")) %>% sort(decreasing = T)
new$new = asendaja(new$new, "tehnoloog", "insener", replace = "tööstusinsener")
new$new = asendaja(new$new, "tehnika", "insener", replace = "elektrotehnikainsener")
new$new = asendaja(new$new, "infra", "insener", replace = "ehitusinsener")
new$new = asendaja(new$new, "ehitus", "peaspets", replace = "ehitusinsener")
table(leidur(new$new, "abi", "töö")) %>% sort(decreasing = T)
new$new = asendaja(new$new, "abi", "töö", excl1 = "staabi", excl2 = "töötuid", replace = "abitööline")
new$new = asendaja(new$new, "abiline", "", excl1 = "kodu", excl2 = "köögi", replace = "abitööline")
new$new = asendaja(new$new, "^abi$", "", replace = "abitööline")
new$new = asendaja(new$new, "ostu", "abi", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügi", "abi", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügitugi", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügiedendaja", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügiinimene", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "turundusabi", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "turundus", "", excl1 = "juht", excl2 = "arhitekt", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügikonsuldant", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügihaldur", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügitoespetsialist", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügikontsultant", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "müügi", "spet", replace = "müügiesindaja")
new$new = asendaja(new$new, "^müügitöö", "", replace = "müügiesindaja")
new$new = asendaja(new$new, "koolitaja", "", replace = "töötajate koolitusspetsialist")
new$new = asendaja(new$new, "vaneminspektor", "", replace = "inspektor")
new$new = asendaja(new$new, "peainspektor", "", replace = "inspektor")
new$new = asendaja(new$new, "juhiasetäitja", "", excl1 = "majandus", replace = "juht")
new$new = asendaja(new$new, "lihttööline", "", excl1 = "tööstuse", replace = "muulihttööline")
new$new = asendaja(new$new, "peakonsultant", "", replace = "konsultant")
new$new = asendaja(new$new, "vanemkonsultant", "", excl1 = "tehnil", replace = "konsultant")
new$new = asendaja(new$new, "vanemteenindaja", "", replace = "teenindaja")
new$new = asendaja(new$new, "^teenindus$", "", replace = "teenindaja")
new$new = asendaja(new$new, "letiteenindaja", "", excl1 = "info", replace = "teenindaja")
new$new = asendaja(new$new, "vanemadministraator", "", replace = "administraator")
new$new = asendaja(new$new, "peaadministraator", "", replace = "administraator")
new$new = asendaja(new$new, "^administraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^vastuvõtuadministraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^administraatorkontoris$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^ujulaadministraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^spordikeskuseadministraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^admistraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "^registraator$", "", replace = "üldadministraator")
new$new = asendaja(new$new, "vanemarendaja", "", replace = "arendaja")
new$new = asendaja(new$new, "automaatik", "", excl1 = "juht", replace = "elektromehaanik")
new$new = asendaja(new$new, "politsei", "", excl1 = "amet", excl2 = "uurija", replace = "politseinik")
new$new = asendaja(new$new, "korrakaitse", "", replace = "politseinik")
new$new = asendaja(new$new, "kiirreag", "", replace = "politseinik")
new$new = asendaja(new$new, "liiklusjärelev", "", replace = "politseinik")
new$new = asendaja(new$new, "operatiivkorrapidaja", "", replace = "politseinik")
new$new = asendaja(new$new, "pottsepp", "", replace = "müürsepp")
new$new = asendaja(new$new, "müürsepp", "", replace = "müürsepp")
new$new = asendaja(new$new, "tänavakivipaigaldus", "", replace = "müürsepp")
new$new = asendaja(new$new, "laboritehnik", "", replace = "keemiatööstustehnik")
table(leidur(new$new, "terapeut", ""))
new$new = asendaja(new$new, "liikumisterapeut", "", replace = "loovterapeut")
new$new = asendaja(new$new, "mänguterapeut", "", replace = "loovterapeut")
new$new = asendaja(new$new, "terapeut", "", excl1 = "loov", excl2 = "füsio", excl3 = "tegevus", replace = "muu nõustaja")
new$new = asendaja(new$new, "peatehnoloog", "", replace = "tehnoloog")
new$new = asendaja(new$new, "productowner", "", replace = "tooteomanik")
new$new = asendaja(new$new, "kontoriabi", "", replace = "kontoriabiline")
new$new = asendaja(new$new, "bürooabi", "", replace = "kontoriabiline")
new$new = asendaja(new$new, "mehhanisaator", "", replace = "mehhanisaator")
new$new = asendaja(new$new, "mehanisaator", "", replace = "mehhanisaator")
new$new = asendaja(new$new, "põranda", "", replace = "põrandategija")
new$new = asendaja(new$new, "vanemmeister", "", replace = "meister")
new$new = asendaja(new$new, "disainer-", "", replace = "disainer")
new$new = asendaja(new$new, "peadisainer", "", replace = "disainer")
new$new = asendaja(new$new, "peauurija", "", replace = "uurija")
new$new = asendaja(new$new, "vaneminsener", "", replace = "insener")
new$new = asendaja(new$new, "vanemuurija", "", replace = "uurija")
new$new = asendaja(new$new, "produtsent", "", replace = "filmi-teatriprodutsent")
new$new = asendaja(new$new, "projektiinsener", "", replace = "insener")
new$new = asendaja(new$new, "^cto$", "", replace = "tehnoloogiajuht")
new$new = asendaja(new$new, "keskastmespetsialist", "", excl1 = "õiguse", replace = "spetsialist")
new$new = asendaja(new$new, "peapiiriametnik", "", replace = "tolliinspektor")
new$new = asendaja(new$new, "peaametnik", "", replace = "ametnik")
new$new = asendaja(new$new, "projektidekoordinaator", "", replace = "projektikoordinator")
new$new = asendaja(new$new, "teenendaja", "", replace = "teenindaja")
new$new = asendaja(new$new, "^engineer$", "", replace = "insener")
new$new = asendaja(new$new, "ehitaja", "", excl1 = "laeva", excl2 = "aadi", excl3 = "maastiku", replace = "ehitaja")
table(leidur(new$new, "õpetaja", "")) %>% sort(decreasing = T)
new$new = asendaja(new$new, "^õpetaja.$", "", replace = "õpetaja")
new$new = asendaja(new$new, "^tööõpetuseõpetaja$", "", replace = "käsitöö-kunstiõpetaja")
new$new = asendaja(new$new, "^õpetajaõppejõud$", "", replace = "õpetaja")
new$new = asendaja(new$new, "^cnc-pingioperaator$", "", replace = "masinaoperaator")
new$new = asendaja(new$new, "^raamatupidamisespetsialist$", "", replace = "raamatupidaja")
new$new = asendaja(new$new, "^ostujuht$", "", replace = "hankejuht")
new$new = asendaja(new$new, "^tehnoloogiajuht$", "", replace = "IKT-juht")
new$new = asendaja(new$new, "mehhanisaator", "", replace = "põllujametsamasinajuht")
new$new = asendaja(new$new, "mehhanik", "", replace = "mehaanik")
new$new = asendaja(new$new, "^mehhaanik$", "", replace = "mehaanik")
new$new = asendaja(new$new, "^salesmanager$", "", replace = "müügijuht")
new$new = asendaja(new$new, "^sekretar$", "", replace = "sekretär")
new$new = asendaja(new$new, "^õpet", "", replace = "õpetaja")
new$new = asendaja(new$new, "^juatusejuht$", "", replace = "juht")
new$new = asendaja(new$new, "^baltikumijuht$", "", replace = "juht")
new$new = asendaja(new$new, "kellassepp", "", replace = "täppisinstrumentidevalmistaja")
new$new = asendaja(new$new, "allmaamäemeister", "", replace = "kaevur")
new$new = asendaja(new$new, "arstina", "", replace = "arst")
new$new = asendaja(new$new, "usaldusarst", "", replace = "arst")
new$new = asendaja(new$new, "^assiste", "", replace = "assistent")
new$new = asendaja(new$new, "^vanemnõunik$", "", replace = "nõunik")
new$new = asendaja(new$new, "^vanemoperaator$", "", replace = "operaator")
new$new = asendaja(new$new, "^vanemametnik$", "", replace = "ametnik")
new$new = asendaja(new$new, "^valdkonnajuht$", "", replace = "juht")
new$new = asendaja(new$new, "^väikeettevõttejuht$", "", replace = "ettevõttejuht")
new$new = asendaja(new$new, "^omanik$", "", replace = "ettevõtja")
new$new = asendaja(new$new, "laev", "ehit", replace = "laevaehitaja")
new$new = asendaja(new$new, "^projektiabi$", "", replace = "juhiabi")
new$new = asendaja(new$new, "^personaliabi$", "", replace = "juhiabi")
# ?
new$new = asendaja(new$new, "^komplekteerija$", "", replace = "pakkija")
# Mõned levinumad venekeelsed, et oleks lihtsalt tehtud
new$new = asendaja(new$new, "^медсестра$", "", replace = "meditsiiniõde")
new$new = asendaja(new$new, "^швея$", "", replace = "õmbleja")
new$new = asendaja(new$new, "^врач$", "", replace = "arst")
new$new = asendaja(new$new, "^инженер$", "", replace = "insener")
new$new = asendaja(new$new, "^парикмахер$", "", replace = "juuksur")
new$new = asendaja(new$new, "^оператор$", "", replace = "operaator")
new$new = asendaja(new$new, "^бухгалтер$", "", replace = "raamatupidaja")
new$new = asendaja(new$new, "^администратор$", "", replace = "administraator")
new$new = asendaja(new$new, "^учитель$", "", replace = "õpetaja")
new$new = asendaja(new$new, "^продавец$", "", replace = "müüja")
new$new = asendaja(new$new, "^повар$", "", replace = "müüja")
new$new = asendaja(new$new, "^главныйбухгалтер$", "", replace = "pearaamatupidaja")
new$new = asendaja(new$new, "^программист$", "", replace = "programmeerija")
new$new = asendaja(new$new, "^директор$", "", replace = "juht")
new$new = asendaja(new$new, "^педагог$", "", replace = "õpetaja")
new$new = asendaja(new$new, "^руководитель$", "", replace = "juht")
new$new = asendaja(new$new, "^водитель$", "", replace = "autojuht")
#### Stop and replace some more values
uh = table(new$new) %>% .[. > 5] %>% names
kodeerimata = new %>% filter(!new %in% uh)
kodeeritud = new %>% filter(new %in% uh)
dic = unique(kodeeritud$new[!is.na(kodeerimata$new)])
check = kodeerimata$new %>% as.character
checked = check_spelling(strtrim(check,60), dictionary = dic,range = 2, assume.first.correct = F)
checked = checked %>% filter(!duplicated(row))
kodeerimata$row = 1:nrow(kodeerimata)
kodeerimata = left_join(kodeerimata %>% select(1:4,10:12), checked[,1:5], by = "row") %>% select(-row)
kodeerimata$dist = stringdist::stringsim(kodeerimata$new, kodeerimata$suggestion)
kodeerimata %>% select(scode:dist) %>% arrange(desc(dist)) %>% filter(dist > .89) %>% tail(30)
i = !is.na(kodeerimata$dist) & (kodeerimata$dist > .89)
kodeerimata$new[i] = kodeerimata$suggestion[i]
tmp = new
new = rbind(kodeerimata, kodeeritud) %>% arrange(match(scode, tmp$scode))
uh = table(new$new) %>% .[. == 1] %>% names
kodeerimata = new %>% filter(new %in% uh)
### now you can use this to get some more ideas: which words are more coommon among those with unique jobs
#strsplit(kodeerimata$workPositionName, "\\W") %>% unlist %>%
#table %>% sort(decreasing = T) %>% .[. > 49]
#table(leidur(kodeerimata$new, "klien","teeninda", excl1 = "juh"))
#table(leidur(kodeerimata$new, "juht","osakonna"))
#table(leidur(kodeerimata$new, "juht","müügi"))
#table(leidur(kodeerimata$new, "juht","projekt"))
#table(leidur(kodeerimata$new, "juht","klien"))
#table(leidur(kodeerimata$new, "arst",""))
#table(leidur(kodeerimata$new, "teadur",""))
#table(leidur(kodeerimata$new, "nõunik",""))
#table(leidur(kodeerimata$new, "","raamatupid"))
#table(leidur(kodeerimata$new, "","spetsialist"))
#table(leidur(kodeerimata$new, "","koordi"))
#table(leidur(kodeerimata$new, "","operaator"))
#table(leidur(kodeerimata$new, "","abi"))
#table(leidur(kodeerimata$new, "","insener"))
### Gruppide moodustamise tegevused
table(new$new) %>% sort(decreasing = T)
vec_count(new$new)
tmp = sort(table(new$new))
tmp[tmp > 100]
tmp[tmp > 100] %>% length
tmp[tmp > 100] %>% sort
pnorm(.5)
pnorm(2/3)
pnorm(3/2)
pnorm(3/2) - pnorm(2/3)
pnorm(1.5)
pnorm(-1.5)
pnorm(1)
1 - pnorm(1)
pnorm(.75)
pnorm(.5)
